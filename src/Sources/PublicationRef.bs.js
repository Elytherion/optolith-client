// Generated by ReScript, PLEASE EDIT WITH CARE

import * as Curry from "bs-platform/lib/es6/curry.js";
import * as Json_decode from "@glennsl/bs-json/src/Json_decode.bs.js";
import * as OneOrMany$OptolithClient from "../Utilities/OneOrMany.bs.js";
import * as JsonStrict$OptolithClient from "../Misc/JsonStrict.bs.js";
import * as Ley_Option$OptolithClient from "../Data/Ley_Option.bs.js";
import * as TranslationMap$OptolithClient from "../Misc/TranslationMap.bs.js";

function t(json) {
  var x = JsonStrict$OptolithClient.field("occurrences", OneOrMany$OptolithClient.Decode.t(function (json) {
            var first = JsonStrict$OptolithClient.field("firstPage", JsonStrict$OptolithClient.$$int, json);
            var maybeLast = JsonStrict$OptolithClient.optionalField("lastPage", JsonStrict$OptolithClient.$$int, json);
            return Ley_Option$OptolithClient.option({
                        TAG: /* Single */0,
                        _0: first
                      }, (function (last) {
                          return {
                                  TAG: /* Range */1,
                                  _0: first,
                                  _1: last
                                };
                        }), maybeLast);
          }), json);
  if (x.TAG) {
    return x._0;
  } else {
    return {
            hd: x._0,
            tl: /* [] */0
          };
  }
}

var Translation = {
  t: t
};

var TranslationMap = TranslationMap$OptolithClient.Make(Translation);

function multilingual(json) {
  return {
          id: Json_decode.field("id", Json_decode.$$int, json),
          translations: Json_decode.field("translations", TranslationMap.Decode.t, json)
        };
}

function multilingualList(param) {
  return Json_decode.list(multilingual, param);
}

function resolveTranslationsList(langs, xs) {
  return Ley_Option$OptolithClient.mapOption((function (param) {
                return Curry._2(Ley_Option$OptolithClient.Infix.$less$amp$great, Curry._2(TranslationMap.Decode.getFromLanguageOrder, langs, param.translations), (function (translation) {
                              return {
                                      id: param.id,
                                      occurrences: translation
                                    };
                            }));
              }), xs);
}

var Decode = {
  multilingualList: multilingualList,
  resolveTranslationsList: resolveTranslationsList
};

export {
  Decode ,
  
}
/* TranslationMap Not a pure module */
