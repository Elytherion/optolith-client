// Generated by ReScript, PLEASE EDIT WITH CARE

import * as Curry from "bs-platform/lib/es6/curry.js";
import * as Ley_List$OptolithClient from "../Data/Ley_List.bs.js";
import * as Ley_IntMap$OptolithClient from "../Data/Ley_IntMap.bs.js";
import * as Ley_IntSet$OptolithClient from "../Data/Ley_IntSet.bs.js";
import * as Ley_Option$OptolithClient from "../Data/Ley_Option.bs.js";

function isPublicationActive(staticPublications, rules, id) {
  var p = Curry._2(Ley_IntMap$OptolithClient.lookup, id, staticPublications);
  if (p !== undefined) {
    if (p.isCore || rules.areAllPublicationsActive && !p.isAdultContent) {
      return true;
    } else {
      return Curry._2(Ley_IntSet$OptolithClient.member, id, rules.activePublications);
    }
  } else {
    return false;
  }
}

function isAvailable(acc, staticPublications, rules, x) {
  return Curry._2(Ley_List$OptolithClient.any, (function (param) {
                return isPublicationActive(staticPublications, rules, param.id);
              }), Curry._1(acc, x));
}

function isAvailableNull(acc, staticPublications, rules, x) {
  var refs = Curry._1(acc, x);
  if (refs) {
    return Curry._2(Ley_List$OptolithClient.any, (function (param) {
                  return isPublicationActive(staticPublications, rules, param.id);
                }), refs);
  } else {
    return true;
  }
}

function isAvailableNullPred(acc, pred, staticPublications, rules, x) {
  var refs = Curry._1(acc, x);
  if (refs && !Curry._1(pred, x)) {
    return Curry._2(Ley_List$OptolithClient.any, (function (param) {
                  return isPublicationActive(staticPublications, rules, param.id);
                }), refs);
  } else {
    return true;
  }
}

function isFromCore(acc, staticPublications, x) {
  return Curry._2(Ley_List$OptolithClient.any, (function (param) {
                return Curry._2(Ley_Option$OptolithClient.any, (function (p) {
                              return p.isCore;
                            }), Curry._2(Ley_IntMap$OptolithClient.lookup, param.id, staticPublications));
              }), Curry._1(acc, x));
}

export {
  isAvailable ,
  isAvailableNull ,
  isAvailableNullPred ,
  isFromCore ,
  
}
/* Ley_List-OptolithClient Not a pure module */
