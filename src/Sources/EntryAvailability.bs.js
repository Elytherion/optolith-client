// Generated by ReScript, PLEASE EDIT WITH CARE
'use strict';

var Curry = require("bs-platform/lib/js/curry.js");
var Ley_List$OptolithClient = require("../Data/Ley_List.bs.js");
var Ley_IntMap$OptolithClient = require("../Data/Ley_IntMap.bs.js");
var Ley_IntSet$OptolithClient = require("../Data/Ley_IntSet.bs.js");
var Ley_Option$OptolithClient = require("../Data/Ley_Option.bs.js");

function isPublicationActive(staticPublications, rules, id) {
  var p = Curry._2(Ley_IntMap$OptolithClient.lookup, id, staticPublications);
  if (p !== undefined) {
    if (p.isCore || rules.areAllPublicationsActive && !p.isAdultContent) {
      return true;
    } else {
      return Curry._2(Ley_IntSet$OptolithClient.member, id, rules.activePublications);
    }
  } else {
    return false;
  }
}

function isAvailable(acc, staticPublications, rules, x) {
  return Curry._2(Ley_List$OptolithClient.any, (function (param) {
                return isPublicationActive(staticPublications, rules, param.id);
              }), Curry._1(acc, x));
}

function isAvailableNull(acc, staticPublications, rules, x) {
  var refs = Curry._1(acc, x);
  if (refs) {
    return Curry._2(Ley_List$OptolithClient.any, (function (param) {
                  return isPublicationActive(staticPublications, rules, param.id);
                }), refs);
  } else {
    return true;
  }
}

function isAvailableNullPred(acc, pred, staticPublications, rules, x) {
  var refs = Curry._1(acc, x);
  if (refs && !Curry._1(pred, x)) {
    return Curry._2(Ley_List$OptolithClient.any, (function (param) {
                  return isPublicationActive(staticPublications, rules, param.id);
                }), refs);
  } else {
    return true;
  }
}

function isFromCore(acc, staticPublications, x) {
  return Curry._2(Ley_List$OptolithClient.any, (function (param) {
                return Curry._2(Ley_Option$OptolithClient.any, (function (p) {
                              return p.isCore;
                            }), Curry._2(Ley_IntMap$OptolithClient.lookup, param.id, staticPublications));
              }), Curry._1(acc, x));
}

exports.isAvailable = isAvailable;
exports.isAvailableNull = isAvailableNull;
exports.isAvailableNullPred = isAvailableNullPred;
exports.isFromCore = isFromCore;
/* Ley_List-OptolithClient Not a pure module */
