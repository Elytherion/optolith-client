// Generated by ReScript, PLEASE EDIT WITH CARE
'use strict';

var Curry = require("bs-platform/lib/js/curry.js");
var Js_math = require("bs-platform/lib/js/js_math.js");
var Json_decode = require("@glennsl/bs-json/src/Json_decode.bs.js");
var Ley_Int$OptolithClient = require("../Data/Ley_Int.bs.js");

function rollDie(sides) {
  return Ley_Int$OptolithClient.inc(Js_math.floor(Math.random() * sides));
}

function $neg$pipe(a, b) {
  if (a >= 0) {
    return a - b | 0;
  } else {
    return a + b | 0;
  }
}

function rollDiceAux(amount, sides) {
  if (Ley_Int$OptolithClient.abs(amount) <= 1) {
    return {
            hd: rollDie(sides),
            tl: /* [] */0
          };
  } else {
    return {
            hd: rollDie(sides),
            tl: rollDiceAux($neg$pipe(amount, 1), sides)
          };
  }
}

function rollDice(param) {
  return rollDiceAux(param.amount, param.sides);
}

function rollDiceSumAux(amount, sides) {
  if (Ley_Int$OptolithClient.abs(amount) <= 1) {
    return rollDie(sides);
  } else {
    return rollDie(sides) + rollDiceSumAux($neg$pipe(amount, 1), sides) | 0;
  }
}

function rollDiceSum(param) {
  return rollDiceSumAux(param.amount, param.sides);
}

function rollDiceSumMapAux(map, amount, sides) {
  if (Ley_Int$OptolithClient.abs(amount) <= 1) {
    return Curry._2(map, {
                amount: amount,
                sides: sides
              }, rollDie(sides));
  } else {
    return Curry._2(map, {
                amount: amount,
                sides: sides
              }, rollDie(sides)) + rollDiceSumMapAux(map, $neg$pipe(amount, 1), sides) | 0;
  }
}

function rollDiceSumMap(f, param) {
  return rollDiceSumMapAux(f, param.amount, param.sides);
}

function t(json) {
  return {
          amount: Json_decode.field("amount", Json_decode.$$int, json),
          sides: Json_decode.field("sides", Json_decode.$$int, json)
        };
}

var Decode = {
  t: t
};

exports.rollDice = rollDice;
exports.rollDiceSum = rollDiceSum;
exports.rollDiceSumMap = rollDiceSumMap;
exports.Decode = Decode;
/* No side effect */
